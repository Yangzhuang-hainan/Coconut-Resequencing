2 数据准备（1）geno文件制作将vcf文件按照染色体分开。${i}表示染色体编号。vcftools --vcf pop.vcf --chr ${i} --recode --stdout > pop.chr${i}.vcf分别制作群体1和群体2的geno文件。plink --vcf pop.chr${i}.vcf --keep pop1.fam --chr ${i} --double-id --out pop.chr${i}.pop1 --recode 01 transpose -output-missing-genotype 9 --allow-extra-chr --set-missing-var-ids @:# --keep-allele-ordercut -d " " -f 5- pop.chr${i}.pop1.tped | awk '{print $0" "}' > pop.chr${i}.pop1.genoplink --vcf pop.chr${i}.vcf --keep pop2.fam --chr ${i} --double-id --out pop.chr${i}.pop2 --recode 01 transpose -output-missing-genotype 9 --allow-extra-chr --set-missing-var-ids @:# --keep-allele-ordercut -d " " -f 5- pop.chr${i}.pop2.tped | awk '{print $0" "}' > pop.chr${i}.pop2.genopop1.fam文件为群体1相同的两列样本编号，使用Tab分割。sample1 sample1sample2 sample2sample3 sample3（2）snp文件制作该文件制作最主要的是需要遗传图谱，计算染色体的重组率。如果所选物种没有，可以自己设置一个（比如1cM/Mb）。每条染色体制作一个文件。文件格式如下：#SNP id cM             SNP    Ref      Alt1:13023 1 0.027588        13023   C       T1:14784 1 0.031319        14784   C       TcM这一列为SNP对应的遗传图距离，为重组率乘以SNP位置。如果没有遗传图，可以简单使用SNP位置除以1000000。需要脚本请联系作者。（3）计算XPCLR每一条染色体单独运行。注意一下，这里的hapmapInput2应该为参考群体。XPCLR -xpclr pop.chr${i}.pop1.geno pop.chr${i}.pop2.geno chr${i}.snp xplcr.chr${i}.out -w1 0.005 200 2000 10 -p0 0.95输出结果文件每一列分别代表：chr# grid# #ofSNPs_in_window physical_pos genetic_pos XPCLR_score max_s。计算完成后把所有染色体合并，选取top 5%的XPCLR_score作为目标候选区域。需要脚本请联系作者。cat xplcr.chr${i}.out > xplcr.out候选区域的基因可以提取出来做GO/KEGG富集。（4）画图简单处理下输出结果用作画图。echo -e "SNP\tCHR\tBP\tXPCLR" > xplcr.out.plotawk -F ' ' '{print $1":"$4"\t"$1"\t"$4"\t"$6}' xplcr.out >> xplcr.out.plot使用R画图。library(qqman)Results<-read.table("xplcr.out.plot ",header=TRUE)pdf("xplcr.out.plot.manhattan.pdf",width=12,height=4)manhattan(Results, p = "XPCLR", logp = FALSE, ylab = "XP-CLR", genomewideline = FALSE,suggestiveline = FALSE, cex = 0.6, cex.axis = 0.9, col =c("darkgreen", "orange3"), ylim = c(0, 400), ) # ylim根据XPCLR_score的最大值设定，最好是整数，坐标轴好看点abline(h=203.137858,lty=3,col="black")# h根据选取top 5%时对应的XPCLR_score设定dev.off()

