1. SNP Filtering and Format Conversion (PLINK)
1.1 Convert VCF to PED Format
vcftools \
  --gzvcf Coconut_SNP.vcf.gz \
  --chrom-map chrom_map.txt \
  --plink \
  --out Coconut.pedformat

1.2 Identify Linkage Disequilibrium (LD) Pruned SNPs
plink \
  --file Coconut.pedformat \
  --indep-pairwise 50 5 0.5 \
  --chr-set n \
  --out plink_filter

1.3 Extract LD-Pruned SNPs
plink \
  --file Coconut.pedformat \
  --extract plink_filter.prune.in \
  --chr-set n \
  --out Coconut.filter.pedformat

1.4 Convert PED to Binary BED Format
plink \
  --file Coconut.filter.pedformat \
  --chr-set n \
  --make-bed \
  --out Coconut.bedformat

2. Principal Component Analysis (PCA)
2.1 Construct Genetic Relationship Matrix (GRM)
gcta64 \
  --bfile Coconut.bedformat \
  --make-grm \
  --autosome \
  --out Coconut_total_SNP.grm

2.2 Perform PCA
gcta64 \
  --grm Coconut_total_SNP.grm \
  --pca 3 \
  --out total.SNP.pca

3. Population Structure Inference (ADMIXTURE)

for k in {2..10}; do
    admixture --cv Coconut.bedformat.bed $k -j8 | tee log${k}.out
done
